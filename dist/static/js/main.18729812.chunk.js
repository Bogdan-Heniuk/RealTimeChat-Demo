(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{43:function(e,t,n){},47:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n(2),s=n(25),r=n.n(s),i=(n(43),n(26)),u=n(10),o=n(20);o.a.apps.length||o.a.initializeApp({databaseURL:"https://chat-e1d30-default-rtdb.europe-west1.firebasedatabase.app",apiKey:"AIzaSyBzugpE4jD6GKke5E1DbJa_7Ige0dnxico",authDomain:"chat-e1d30.firebaseapp.com",projectId:"chat-e1d30",storageBucket:"chat-e1d30.appspot.com",messagingSenderId:"1048710430565",appId:"1:1048710430565:web:84b7570ba31fabf1a1eb8c"});var j=o.a.auth(),b=o.a,l=new function e(){var t=this;Object(i.a)(this,e),this.user=null,this.isInitialized=!1,this.signOut=function(){return b.auth().signOut()},this.subscribeToAuthStateChanged=function(){b.auth().onAuthStateChanged((function(e){t.user=e,t.isInitialized=!0}))},Object(u.d)(this)},d=n(12),h=Object(d.a)((function(){return Object(a.jsx)("nav",{children:Object(a.jsxs)("div",{className:"nav-wrapper",children:[Object(a.jsx)("a",{style:{marginLeft:"10px"},href:"#",className:"brand-logo",children:"React-chat"}),l.user&&Object(a.jsx)("i",{style:{width:10,height:10},onClick:l.signOut,className:"material-icons sign-out",children:"exit_to_app"})]})})})),f=(n(47),n(14)),p=n.n(f),O=n(17),x=function(){var e=function(){var e=Object(O.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new o.a.auth.GoogleAuthProvider,e.next=3,j.signInWithPopup(t);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var t=Object(O.a)(p.a.mark((function t(n){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,e();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsx)("div",{className:"row register",children:Object(a.jsxs)("div",{onClick:t,className:"google-btn",children:[Object(a.jsx)("div",{className:"google-icon-wrapper",children:Object(a.jsx)("img",{className:"google-icon",src:"https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg"})}),Object(a.jsx)("p",{className:"btn-text",children:Object(a.jsx)("b",{children:"Sign in with google"})})]})})},v=n(22),g=n(9),m=Object(d.a)((function(e){return Object(a.jsxs)("div",{style:{flexDirection:l.user.uid===e.data.user_id?"row-reverse":"row"},className:"message flex",children:[Object(a.jsx)("div",{children:Object(a.jsx)("img",{referrerPolicy:"no-referrer",className:"avatar",src:e.data.avatar,alt:""})}),Object(a.jsx)("div",{className:"text",children:e.data.title})]})})),w=n(35),N=new(function(){function e(){var t=this;Object(i.a)(this,e),this.messages=[],this.onMessage=function(e){t.messages=Object.values(e.val()||{})},Object(u.d)(this)}return Object(w.a)(e,[{key:"subscribeToMessages",value:function(){var e=Object(O.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.database().ref("messages").on("value",this.onMessage);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addMessage",value:function(){var e=Object(O.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.database().ref("messages").push(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}()),y=function(){var e=Object(c.useRef)();return Object(c.useEffect)((function(){return e.current.scrollIntoView()})),Object(a.jsx)("div",{ref:e})},k=Object(d.a)((function(){return Object(a.jsxs)("div",{className:"messages",children:[N.messages.map((function(e){return Object(a.jsx)(m,{data:e},e.id)})),Object(a.jsx)(y,{})]})})),I=n(16),E=n(37);var D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object(c.useState)(e),a=Object(E.a)(n,2),s=a[0],r=a[1],i=t.onEnter,u=function(e){"Enter"===e.key&&"function"===typeof i&&i()};return{bind:{onKeyDown:u,value:s,onChange:function(e){return r(e.target.value)}},value:function(){return s},clear:function(){return r("")}}},C=Object(d.a)((function(){var e=D("",{onEnter:n}),t=!e.value().trim().length;function n(){return c.apply(this,arguments)}function c(){return(c=Object(O.a)(p.a.mark((function n(){return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,N.addMessage({user_id:l.user.uid,id:Date.now(),title:e.value(),avatar:l.user.providerData[0].photoURL});case 4:e.clear();case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(a.jsxs)("div",{className:"input-field flex",children:[Object(a.jsx)("input",Object(I.a)(Object(I.a)({},e.bind),{},{className:"validate"})),Object(a.jsx)("div",{className:"send-button",children:Object(a.jsx)("button",{disabled:t,onClick:n,className:"btn-floating btn-large red",children:Object(a.jsx)("i",{style:{marginLeft:"2.5px"},className:"large material-icons",children:"send"})})})]})})),S=function(){return Object(c.useEffect)((function(){N.subscribeToMessages()})),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{className:"row content",children:Object(a.jsx)("div",{className:"col s12",children:Object(a.jsx)(k,{})})}),Object(a.jsx)("div",{className:"row input",children:Object(a.jsx)("div",{className:"col s12",children:Object(a.jsx)(C,{})})})]})},_=n(29),z=Object(d.a)((function(e){var t=e.component,n=Object(_.a)(e,["component"]),c=l.user;return Object(a.jsx)(g.b,Object(I.a)(Object(I.a)({},n),{},{render:function(e){return c?Object(a.jsx)(g.a,{to:"/chat"}):Object(a.jsx)(t,Object(I.a)({},e))}}))})),A=Object(d.a)((function(e){var t=e.component,n=Object(_.a)(e,["component"]),c=l.user;return Object(a.jsx)(g.b,Object(I.a)(Object(I.a)({},n),{},{render:function(e){return c?Object(a.jsx)(t,Object(I.a)({},e)):Object(a.jsx)(g.a,{to:"/register"})}}))})),M=Object(d.a)((function(){return l.user?Object(a.jsx)(g.a,{to:"/chat"}):Object(a.jsx)(g.a,{to:"/register"})})),L=Object(d.a)((function(){return Object(c.useEffect)((function(){l.subscribeToAuthStateChanged()}),[]),l.isInitialized?Object(a.jsx)(v.a,{children:Object(a.jsxs)("div",{className:"app",children:[Object(a.jsx)("div",{className:"navbar",children:Object(a.jsx)(h,{})}),Object(a.jsxs)(g.d,{children:[Object(a.jsx)(A,{path:"/chat",exact:!0,component:S}),Object(a.jsx)(z,{path:"/register",exact:!0,component:x}),Object(a.jsx)(g.b,{path:"*",component:M})]})]})}):null}));r.a.render(Object(a.jsx)(L,{}),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.18729812.chunk.js.map